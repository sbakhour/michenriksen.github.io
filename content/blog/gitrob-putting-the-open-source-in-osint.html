---
title: "Gitrob: Putting the Open Source in OSINT"
kind: article
created_at: 2015-01-12 13:37:00 UTC
---

<%= render 'post_head', :post => item %>

<p>Developers generally like to share their code, and many of them do so by open
sourcing it on <a href="https://github.com">GitHub</a>, a social code hosting
and collaboration service. Many companies also use GitHub as a convenient place
to host both private and public code repositories by creating GitHub organizations
where employees can be joined.</p>

<p>Sometimes employees might publish things that should not be publicly
available. Things that contain sensitive information or things that could even
lead to direct compromise of a system. This can happen by accident or because
the employee does not know the sensitivity of the information.</p>

<p><a href="https://github.com/michenriksen/gitrob">Gitrob</a> is a command line
tool that can help organizations and security professionals find such sensitive
information. The tool will iterate over all public organization and member
repositories and match filenames against a range of patterns for files that
typically contain sensitive or dangerous information.</p>

<h3>How it works</h3>

<p>Looking for sensitive information in GitHub repositories is not a new thing,
it has been <a href="http://blog.conviso.com.br/2013/06/github-hacking-for-fun-and-sensitive.html" rel="nofollow">known for a while</a>
that things such as private keys and credentials can be found with GitHub's
search functionality, however Gitrob makes it easier to focus the effort on a specific
organization.</p>

<p>The first thing the tool does is to collect all public repositories of the
organization itself. It then goes on to collect all the organization members and
their public repositories, in order to compile a list of repositories that might
be related or have relevance to the organization.</p>

<a class="fancybox" href="/images/gitrob/gitrob_collecting_repos.png" title="Gitrob collecting repositories from organization members.">
  <img class="thumbnail" src="/images/gitrob/gitrob_collecting_repos_thumb.png" alt="" />
</a>

<p>When the list of repositories has been compiled, it proceeds to gather all the
filenames in each repository and runs them through a series of observers
that will flag the files, if they match any patterns of known sensitive files.
This step might take a while if the organization is big or if the members have
a lot of public repositories.</p>

<a class="fancybox" href="/images/gitrob/gitrob_analyzing_repos.png" title="Gitrob sifting through collected repositories and flagging interesting files.">
  <img class="thumbnail" src="/images/gitrob/gitrob_analyzing_repos_thumb.png" alt="" />
</a>

<p>All of the members, repositories and files will be saved to a PostgreSQL database.
When everything has been sifted through, it will start a
<a href="http://www.sinatrarb.com">Sinatra</a> web server locally on the machine,
which will serve a simple web application to present the collected data for
analysis.</p>

<a class="fancybox" href="/images/gitrob/gitrob_findings.png" title="Interesting files across all repositories are shown in one list for easy analysis. The quick filter in the top right corner can be used to look for specific files.">
  <img class="thumbnail" src="/images/gitrob/gitrob_findings_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/gitrob_findings_details.png" title="Clicking on a file will show its contents with syntax highlighting. It will also show why the file was flagged.">
  <img class="thumbnail" src="/images/gitrob/gitrob_findings_details_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/gitrob_members.png" title="Members of the organization can be viewed in a grid layout. Members with interesting files are easy to spot.">
  <img class="thumbnail" src="/images/gitrob/gitrob_members_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/gitrob_members_details.png" title="Clicking on a member will show their basic information and public repositories. Repositories with findings are highlighted with an orange background.">
  <img class="thumbnail" src="/images/gitrob/gitrob_members_details_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/gitrob_repos.png" title="All collected repositories can be viewed in a table with their descriptions and website URLs. Repositories with findings are highlighted with an orange background.">
  <img class="thumbnail" src="/images/gitrob/gitrob_repos_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/gitrob_repo.png" title="All files in a specific repository can be viewed. The quick filter in the top right corner can be used to look for specific files.">
  <img class="thumbnail" src="/images/gitrob/gitrob_repo_thumb.png" alt="" />
</a>

<h3>Some findings</h3>

<p>While developing Gitrob, I tested it against many different organizations belonging
to various companies, big and small, both to expose the tool to a lot of real-life
data and to notify the companies of any findings before release.</p>

<p>The tool found several interesting things ranging from low-level,
to bad and all the way to company-destroying kind of information
disclosure. Here's some examples...</p>

<p><strong>Note:</strong> I have redacted sensitive and identifying information
in the screenshots; I am not interested in embarrassing or exposing anyone. And
again, all these findings have been reported.</p>

<a class="fancybox" href="/images/gitrob/finding1.png" title="Found in a <code>.bash_profile</code> file, the employee was thoughtful enough to mask the passwords, but still mapped out a big chunk of infrastructure with his command aliases. It also tells attackers that spear-phishing this employee will likely give them root access to a lot of databases.">
  <img class="thumbnail" src="/images/gitrob/finding1_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding2.png" title="Found in a <code>.bash_profile</code> file, the command aliases revealed the existence of a secret <em>black site</em> domain used for the company's tools for everyday operations such as analytics, metrics and  continuous integration. A big increase in attack surface.">
  <img class="thumbnail" src="/images/gitrob/finding2_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding3.png" title="Command history files can contain a lot of sensitive information, such as passwords, API keys and hostnames.">
  <img class="thumbnail" src="/images/gitrob/finding3_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding4.png" title="A developer had open sourced a Wordpress website, including a complete database dump with password hash for his user account. Maybe the same password is used somewhere else?">
  <img class="thumbnail" src="/images/gitrob/finding4_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding5.png" title="An <code>.env</code> file for a chat bot contained several credentials. Apart from an attacker being able to spy on their Campfire chat and steal stuff from the data stores, they would also be able to control the temperature somewhere with the Nest credentials.">
  <img class="thumbnail" src="/images/gitrob/finding5_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding6.png" title="A company had open sourced their documentation website, a simple Ruby On Rails application. They forgot to remove the application secret token, which can be <a href='http://www.rapid7.com/db/modules/exploit/multi/http/rails_secret_deserialization'>exploited</a> to achieve remote code execution.">
  <img class="thumbnail" src="/images/gitrob/finding6_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding7.png" title="A developer had checked in his KeePass password database containing 174 entries. The data is heavily encrypted, but the master password can be <a href='https://github.com/darkk/keebrute'>brute-forced</a>. In this case the company was certainly interesting enough for someone to throw a lot of computing power at that task.">
  <img class="thumbnail" src="/images/gitrob/finding7_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding8.png" title="Amazon EC2 credentials found in a <code>.zshrc</code> file. depending on the level of privilege, it can potentially give complete control of the company's infrastructure.">
  <img class="thumbnail" src="/images/gitrob/finding8_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding9.png" title="An employee had checked in an Amazon EC2 private key which can potentially give complete control of the company's infrastructure.">
  <img class="thumbnail" src="/images/gitrob/finding9_thumb.png" alt="" />
</a>

<a class="fancybox" href="/images/gitrob/finding10.png" title="The same employee from the last screenshot also checked in his private SSH key, which could potentially grant access to the company's SSH servers. It could potentially also be used to clone private organization repositories.">
  <img class="thumbnail" src="/images/gitrob/finding10_thumb.png" alt="" />
</a>

<h3>Installing and setting up Gitrob</h3>

<p>Gitrob is written in Ruby and requires at least version 1.9.3 or above. If you
are on an older version, it is very easy to install newer versions with <a href="http://rvm.io/">RVM</a>.
If you are installing Gitrob on <a href="http://www.kali.org/">Kali</a>, you
are almost good to go, you just need to update Bundler with <code>gem install bundler</code>.
It might also be necessary to install a PostgreSQL dependency with <code>apt-get
install postgresql-server-dev-9.1</code> in a terminal.</p>

<p>Gitrob is a Ruby gem, so installation is a simple <code>gem install gitrob</code>
in a terminal. This will automatically install all the code dependencies as well.<p>

<p>A <a href="http://www.postgresql.org/">PostgreSQL</a> database is also needed
for Gitrob to store its data. Installing PostgreSQL is pretty straight forward;
here is an installation guide for <a href="http://www.gotealeaf.com/blog/how-to-install-postgresql-on-a-mac">Mac OS X</a>
and one for <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-14-04">Ubuntu/Debian</a> based Linux.
If you're installing Gitrob on Kali, you already have PostgreSQL installed, however
you need to start the server with <code>service postgresql start</code> in a terminal.</p>

<p>When PostgreSQL is installed, it's time to create a user and a database for
Gitrob. To do so, type the following commands in a terminal:</p>

<pre>
sudo su postgres # Not necessary on Mac OS X
createuser -s gitrob --pwprompt
createdb -O gitrob gitrob
</pre>

<p>The last thing we need is a GitHub access token in order to be able to talk
to their API. The easiest way is to create a <a href="https://github.com/settings/applications">personal access token</a>.
If you plan on using Gitrob extensively or on a very big organization, it might be
necessary turn down the amount of threads used and maybe configure Gitrob to use
access tokens from you and your colleagues, to avoid running into rate limiting.<p>

<p>When everything is ready, simply run <code>gitrob --configure</code> and you
will be presented with a configuration wizard that asks you for database connection
details and GitHub access tokens. All of this configuration can be changed by
running the same command again. The configuration will be saved in <code>~/.gitrobrc</code>
- and yes, Gitrob is looking for this file too so watch out.</p>

<a class="fancybox" href="/images/gitrob/gitrob_configuration.png" title="Setting up Gitrob with the configuration wizard.">
  <img class="thumbnail" src="/images/gitrob/gitrob_configuration_thumb.png" alt="" />
</a>

<p>When everything is set up, you can start analyzing organizations by running
<code>gitrob -o &lt;orgname&gt;</code> in a terminal. To see options, use
<code>gitrob --help</code>.</p>

<h3>Why I created Gitrob</h3>

<p>I work in the security team at <a href="https://soundcloud.com/">SoundCloud</a>
(<a href="https://soundcloud.com/jobs">We're hiring</a>, btw) and one of my recent
tasks has been to create a system that continuously watches our GitHub organization
for various things that might be a security risk, including looking for potential
sensitive files in repositories. During development, I thought it would be
interesting to take parts of this system and open sourcing it as a tool that
can be used both defensively and offensively.</p>

<p>If you are responsible for security at a company that uses GitHub for hosting
code, Gitrob can be used to periodically check your organization for any sensitive
files that might be lingering in repositories.</p>

<p>If you are on the offensive side, like a professional penetration tester, Gitrob
can be used in the initial information gathering stage to look for anything that
might give you a foothold or increase the target's attack surface. Gitrob can also
give you usernames, names, email addresses and names of internal systems that are
useful in phishing campaigns and social engineering attacks. If you are lucky,
Gitrob can even give you complete pwnage without ever sending a single malicious
packet to the target's systems.</p>

<h3>Helping out</h3>

<p>Gitrob should be considered Beta and there is probably a good amount of bugs.
<a href="https://github.com/michenriksen/gitrob/issues">Bug reports</a> and
suggestions for improvements are welcome!</p>

<p>Another way to help out is to contribute new patterns for sensitive files.
If you know of any sensitive files that are not already identified, please submit
them in a pull request on <a href="https://github.com/michenriksen/gitrob">GitHub</a>.
I am especially interested in sensitive web framework files and configuration
files. Have a look at the <a href="https://github.com/michenriksen/gitrob/blob/master/patterns.json">patterns.json</a>
file to see what is already looked for.</p>

<p><strong>Have fun and be responsible!</strong></p>
